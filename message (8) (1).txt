Segue a Especificação — MVP Mordomia Financeira (PWA offline-first, zero back-end) atualizada conforme orientações de linguagem (“Comunicação na interface”, “textos das telas”, “plano gratuito”, “marca d’água”), com: Gating local (licença) da versão Pro (Opção A: pagamento externo + chave/arquivo); Incentivo a doação com pequenas melhorias; Grupos de WhatsApp (gratuito e Pro) como canal de contato/validação; Explicação clara das categorias e subcategorias e regra: não editáveis no plano gratuito. 1) Resumo executivo (5 pontos) Propósito: app PWA de mordomia financeira que operacionaliza dízimo 10% e ofertas por grau de meta, com orçamento simples e conciliação básica — tudo local, sem coleta de dados pessoais. Persona (MVP): indivíduo (uso local), sem sincronização; backup manual. Arquitetura: PWA 100% offline, zero back-end, sem analytics; armazenamento em IndexedDB (Dexie); exportação CSV/PDF no cliente. Monetização: Pro por fora via licença local (desbloqueia MR, PL, Export completos); plano gratuito com limites e/ou marca d’água; apoio por doação com pequenas melhorias. Princípios: dízimo = 10% da base; ofertas por grau de meta; respeito ao Sábado (bloqueios no período sabático). 2) Decisões-chave (trade-offs) Sem login/servidor/analytics → +privacidade, +velocidade, custo ≈ R$0; –sincronização e –telemetria. Licença local (Pro) → gating offline; aceitar algum compartilhamento (mitigar com expiração). PWA primeiro → entrega barata e rápida; observar quota de armazenamento em alguns navegadores. 3) Princípios doutrinários → regras de negócio Base de renda (mensal): soma dos lançamentos Entrada em categoria=Renda e subcategoria=Renda. Dízimo: 10% da base. Ofertas regulares: sobre a mesma base, conforme grau de meta do mês. Ofertas pontuais: em Fidelidade → Outros (Fidelidade); não alteram base/grau. Renda variável/13º/prêmios: entram como Renda no mês do lançamento. Manejo (transferências internas): efeito patrimonial, não compõe renda. Grau de meta (faixas mensais): ≤ R$ 1.000 → Sub; >1k–4k → M1; >4k–7k → M2; >7k–10k → M3; >10k–13k → M4; >13k–16k → M5. Distribuição por categoria (soma = 100% da renda): conforme tabela que você definiu (Fidelidade/Essencial/Incremental/Cobertura/Emergencial/Projetos/Amenidades), com os percentuais de Sub, M1, M2, M3, M4 e M5. 4) Categorias e subcategorias (explicação + regra de edição) Regra de edição: Plano gratuito: categorias e subcategorias pré-definidas e não editáveis. Pro: habilita personalização limitada (ex.: renomear, ocultar, acrescentar subcategorias dentro de cada categoria, respeitando regras de Fidelidade). Fidelidade Propósito: consagração a Deus. Subcategorias: Dízimo (10%), Oferta | Pacto, Oferta Missionária, Oferta Humanitária, Ofertas | Diversas, Outros (Fidelidade) para pontuais. Observação: Dízimo é sempre 10% da base; ofertas regulares seguem o grau do mês. Essencial Propósito: necessidades básicas (moradia, alimentação, saúde básica, transporte essencial). Exemplos: aluguel/condomínio, supermercado básico, medicamentos contínuos, transporte diário. Incremental Propósito: crescimento e capacitação. Exemplos: educação/cursos, livros, ferramentas de trabalho/estudo. Cobertura Propósito: proteção e obrigações. Exemplos: seguros (vida/auto), impostos/anuidades, manutenção obrigatória. Emergencial Propósito: reserva para imprevistos. Exemplos: fundo emergencial, provisões de curto prazo. Projetos Propósito: metas planejadas. Exemplos: reforma, viagem, aquisição relevante. Amenidades Propósito: conforto e lazer moderado. Exemplos: passeios, presentes, entretenimento. 5) Escopo do MVP (PWA offline) Inclui (plano gratuito + Pro) AJ (Ajustes): parâmetros de grau; contas básicas; taxonomia padrão (categorias/subcategorias). RD (Renda): previsão/real; cálculo automático do grau do mês. EV (Envelope/Fidelidade): Dízimo (10%) + Ofertas por grau + pontuais. CR (Lançamentos): entradas/saídas/manejo, tipificação assistida; atalhos (Devolver Dízimo, Ofertar, Transferir). Modo Sabático (manual): bloqueio de transações; leitura/consagração permitidas. Backup/Restaurar: arquivo .mf.json (hash de integridade). Export: CSV/PDF no cliente (ver limites abaixo). Gating local (licença Pro) e incentivo por doação Plano gratuito (sem licença): MR (Monitor): visão resumida (ex.: mês corrente e 1 mês anterior) e/ou limite de visualizações mensais; textos das telas convidando a apoiar. PL (Patrimônio): saldos por conta sem detalhar ΔReal vs ΔCalculado (ou com Δ apenas do mês corrente); limite de visualizações. Export: CSV/PDF parciais (ex.: somente mês corrente), com marca d’água “Versão gratuita”. Pro (com licença local): MR: KPIs mínimos completos + silêncio sabático (sem limites). PL: saldos por conta + ΔReal vs ΔCalculado (divergências simples). Export: CSV/PDF completos (fidelidade + conciliação) sem marca d’água. Personalização limitada de categorias/subcategorias. Apoiador (doação, sem chegar a Pro): Pequenas melhorias sem coletar dados (entrega via “licença de apoio”): Aumento do limite de visualizações em MR/PL; Flexibilização de limites de exportação (PDF até X meses); Outras melhorias simples que se provarem úteis. Observação: a alternativa “URL Pro (build com senha)” foi descartada por ora. 6) Fluxos principais Ajustes (inicial): configurar contas; confirmar parâmetros de grau (locais). Mensal (RD → EV → CR → MR → PL): RD: revisar base e grau do mês. EV: confirmar Dízimo/Ofertas regulares; incluir pontuais (Outros/Fidelidade). CR: lançar entradas/saídas/manejo (atalhos). MR: consultar KPIs (mês atual e histórico conforme plano). PL: verificar saldos e (no Pro) ΔReal vs ΔCalculado. Export/Backup: gerar CSV/PDF; criar/restaurar .mf.json. Desbloquear Pro: colar chave/importar .mfp → validação local → recursos Pro ativos. Grupos WhatsApp: botões para entrar no grupo do plano gratuito e no grupo Pro (links externos). 7) Comunicação na interface (textos das telas) Plano gratuito — banners/avisos: “Você está usando o plano gratuito. Algumas funções são resumidas. Apoie para ampliar limites.” “Exportação completa disponível no Pro. Gere um PDF resumido com marca d’água ou desbloqueie o Pro.” “Categorias e subcategorias não são editáveis no plano gratuito.” Botões/CTAs: “Desbloquear Pro” • “Apoiar o projeto” • “Entrar no grupo WhatsApp (gratuito)” • “Entrar no grupo WhatsApp (Pro)” “Fazer backup agora” • “Restaurar backup” • “Configurar pôr-do-sol” Modo sabático: “Sábado: lançamentos e exportações estão temporariamente indisponíveis. Aproveite conteúdos de leitura e consagração.” 8) Arquitetura & stack PWA: React + TypeScript (Vite/Next) + Tailwind + shadcn/ui. Armazenamento local: IndexedDB (Dexie) com versionamento de schema. Export: CSV (Blob) e PDF (jsPDF/pdf-lib). Licenças (Pro/Apoiador): verificação Ed25519 (tweetnacl); chave pública no app; geração de licenças via CLI offline. Hospedagem: Vercel/Cloudflare Pages (estático). Acessibilidade e i18n: WCAG AA; pt-BR. 9) Modelo de dados (local) ConfigLocal: { id:'config', tz, porDoSolManual, versaoSchema, flags } Conta: { id, nome, tipo: 'banco'|'especie'|'aplicacao', saldoInicial } Categoria: { id, nome, bloqueadaNoGratuito:true } Subcategoria: { id, categoriaId, nome, bloqueadaNoGratuito:true } Lancamento: { id, dataISO, tipo:'Entrada'|'Saida'|'Manejo', valor, contaOrigem?, contaDestino?, categoriaId, subcategoriaId?, obs? } ParametroGrau: { id, grau, faixaMin, faixaMax, percentuaisJSON } Licenca: { id:'license', tipo:'pro'|'apoio', payloadB64, assinaturaB64 } 10) Motor (grau/dízimo/ofertas) — núcleo (TS) type Grau = 'SUB'|'M1'|'M2'|'M3'|'M4'|'M5'; export function grauDeMeta(renda:number): Grau { if (renda <= 1000) return 'SUB'; if (renda <= 4000) return 'M1'; if (renda <= 7000) return 'M2'; if (renda <= 10000) return 'M3'; if (renda <= 13000) return 'M4'; return 'M5'; } (Distribuições/percentuais conforme tabela já definida; incluir testes de soma=100% e bordas.) 11) Licenças locais (Pro/Apoiador) Formato: payloadBase64.assinaturaBase64, onde payload inclui: { edition:'pro'|'apoio', features:['mr','pl','export?'], exp?:epoch, version:1, nonce:'...' } Validação local (exemplo): import nacl from 'tweetnacl'; import { decodeBase64, encodeUTF8 } from 'tweetnacl-util'; const PUB_B64 = '…'; // chave pública export function validarLicenca(lic:string){ const [p,s] = lic.split('.'); if(!p||!s) throw 'Licença inválida'; const ok = nacl.sign.detached.verify(decodeBase64(p), decodeBase64(s), decodeBase64(PUB_B64)); if(!ok) throw 'Assinatura inválida'; const payload = JSON.parse(encodeUTF8(decodeBase64(p))); if (payload.exp && Date.now()>payload.exp) throw 'Licença expirada'; localStorage.setItem('mf_license', lic); return payload; // edition:'pro'|'apoio' } export const temPro = () => { const lic = localStorage.getItem('mf_license'); if(!lic) return false; try { return validarLicenca(lic).edition==='pro'; } catch { return false; } }; export const temApoio = () => { const lic = localStorage.getItem('mf_license'); if(!lic) return false; try { return validarLicenca(lic).edition==='apoio'; } catch { return false; } }; Gating sugerido (exemplos): MR/PL: Gratuito: 10 visualizações/mês cada. Apoiador: 30 visualizações/mês cada. Pro: ilimitado. Export PDF: Gratuito: mês corrente com marca d’água. Apoiador: até 3 meses/PDF, marca d’água menor. Pro: período livre, sem marca d’água. (Números podem ser ajustados após testes.) 12) Exportação local (CSV/PDF) CSV: Blob + download (URL.createObjectURL). PDF: jsPDF/pdf-lib. Plano gratuito com marca d’água; Pro sem. Durante o Sábado: respeitar bloqueio (geração liberada após pôr-do-sol). 13) LGPD & jurídico (sem coleta) Termos (obrigatório, no app): “Não coletamos dados pessoais. Seus dados permanecem apenas neste dispositivo.” “Exportações e backups são opcionais e sob seu controle.” “Pagamentos e emissão de licenças são processados por terceiros; o app não envia dados.” Privacidade: política curta embutida (markdown). Grupos WhatsApp: links externos (convite); sem captura de telefone no app. Sábado: descrever claramente o comportamento (bloqueios permitidos/negados). 14) Acessibilidade, i18n e UX sabático WCAG AA: contraste, navegação teclado, labels/ARIA. pt-BR por padrão; tom respeitoso e claro. Sabático: configuração manual do pôr-do-sol; bloquear lançamentos/exportações/visões que incentivem transação; permitir leitura/consagração. 15) Observabilidade local & validação sem analytics Tela “Diagnóstico”: contagem de lançamentos, % meses com dízimo/ofertas, tamanho da base. Feedback voluntário: botão “Enviar feedback” → mailto: com JSON anônimo (o usuário decide enviar). Grupos WhatsApp: principais canais de contato e validação contínua (um para plano gratuito, outro para Pro). 16) Roadmap (4–6 semanas; evitar marcos no Sábado) S1: PWA base + Dexie + Ajustes + motor (grau/dízimo/ofertas) + modo sabático. S2: RD/EV/CR; atalhos; bloqueios sabáticos. S3: MR/PL (com limites do plano gratuito); Export CSV/PDF (marca d’água). S4: Licenças (Pro/Apoiador); Backup/Restaurar; Termos/Privacidade; Grupos WhatsApp; QA/A11y. Buffer (S5–S6): polimento, piloto com grupos e ajustes. 17) Riscos & mitigação Perda de dados ao trocar dispositivo: reforçar backup (lembretes locais). Quota do navegador: alertas de espaço; orientar exportar CSV/PDF. Compartilhamento de licença: aceitar no MVP; usar expiração e esclarecer na interface. Erro de classificação (Manejo vs Renda): assistentes de lançamento e validações no fechamento. Grupos WhatsApp: monitorar spam/conduta; fixar regras; moderadores. 18) Checklist de qualidade (MVP) Zero chamadas de rede para funções principais. Sem analytics, cookies ou coletores. Termos/Privacidade (sem coleta) acessíveis offline. Categorias/subcategorias não editáveis no plano gratuito (mensagens claras). Cálculos validados (soma = 100%; bordas dos graus). Modo Sabático: bloqueios funcionais e textos das telas adequados. MR/PL/Export com limites no plano gratuito; Pro/Apoiador conforme licença. Export PDF com marca d’água no plano gratuito. Backup/Restaurar .mf.json com hash. Acessibilidade (WCAG AA) e pt-BR. Próximos passos Confirmar limites numéricos de MR/PL/Export para plano gratuito e Apoiador. Revisar os textos das telas (banners, botões, mensagens de sabático, avisos de edição bloqueada no plano gratuito). Validar os links de convite para os grupos WhatsApp (gratuito e Pro). Definir expiração padrão das licenças (Pro/Apoiador) e o layout da marca d’água no PDF do plano gratuito. Se aprovar, já preparo o esqueleto PWA com: Dexie, cálculo de graus, bloqueios sabáticos, MR/PL/Export com limites e Comunicação na interface conforme acima, incluindo a tela de Desbloquear Pro e o fluxo de Backup/Restaurar — tudo sem back-end.